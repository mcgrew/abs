# Maintainer: pisuka <tekmon@gmail.com>
# Contributor: Estevao Valadao <estevao@archlinux-br.org>
# Contributor: Guten <ywzhaifei@gmail.com>
# Contributor: Lee.MaRS <leemars@gmail.com>

pkgname=google-appengine-python
pkgver=1.6.4
pkgrel=1
arch=(any)
pkgdesc="Google App Engine SDK for Python."
url=http://code.google.com/appengine/
license=(APACHE)
#depends=(python25-ssl python25-pil)
#optdepends=(python-imaging=1.1.7 python2-numpy=1.6.1 pycrypto=2.3 python-lxml=2.3 python2)
makedepends=(unzip)
options=(!strip)
install=install
source=(http://googleappengine.googlecode.com/files/google_appengine_${pkgver}.zip)
noextract=(google_appengine_${pkgver}.zip)
sha1sums=(72b5bf9a61d5c3b1dff591f3cf313dc0e80a31da)

build() {
  cd "$pkgdir"
  mkdir -p opt usr/bin

  # Extract with unzip as bsdtar screws up permissions
  unzip -q "$srcdir/google_appengine_${pkgver}.zip" -d opt

  grep -r -l python opt/google_appengine | xargs sed -i '/#!\/usr\/bin\/env python/s|python|python2\.5|'

  find opt/google_appengine -maxdepth 1 -type f -executable -printf "/opt/google_appengine/%f\n" | xargs ln -st usr/bin/
}

